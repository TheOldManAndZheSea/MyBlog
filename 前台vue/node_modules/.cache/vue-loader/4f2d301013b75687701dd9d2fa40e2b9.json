{"remainingRequest":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\admin\\Blog_input.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\admin\\Blog_input.vue","mtime":1628309540000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgYmxvZzogewogICAgICAgICAgICAgICAgaWQ6bnVsbCwKICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICIiLAogICAgICAgICAgICAgICAgZmxhZzogIiIsCiAgICAgICAgICAgICAgICB0aXRsZTogIiIsCiAgICAgICAgICAgICAgICB0eXBlOiB7fSwKICAgICAgICAgICAgICAgIHRhZ0lkczogJycsCiAgICAgICAgICAgICAgICBmaXJzdFBpY3R1cmU6ICIiLAogICAgICAgICAgICAgICAgYXBwcmVjaWF0aW9uOiAwLAogICAgICAgICAgICAgICAgdXNlcjoge30sCiAgICAgICAgICAgICAgICB2aWV3czogMCwKICAgICAgICAgICAgICAgIGNvbW1lbnRhYmxlZDogdHJ1ZQogICAgICAgICAgICB9LAogICAgICAgICAgICBkaWFsb2dJbWFnZVVybDonJywKICAgICAgICAgICAgZmxhZ3M6IFsKICAgICAgICAgICAgICAgIHt2YWx1ZTogIuWOn+WImyIsIGxhYmVsOiAi5Y6f5YibIn0sCiAgICAgICAgICAgICAgICB7dmFsdWU6ICLovazovb0iLCBsYWJlbDogIui9rOi9vSJ9LAogICAgICAgICAgICAgICAge3ZhbHVlOiAi57+76K+RIiwgbGFiZWw6ICLnv7vor5EifQogICAgICAgICAgICBdLAogICAgICAgICAgICBwdWJsaXNoRGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLAogICAgICAgICAgICBwdWJsaXNoRm9ybTogewogICAgICAgICAgICAgICAgLy8gdHlwZToge30sCiAgICAgICAgICAgICAgICB0YWdzOiBbXSwKICAgICAgICAgICAgICAgIGZsYWc6J+WOn+WImycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdHlwZUxpc3Q6IFtdLAogICAgICAgICAgICB0YWdMaXN0OiBbXSwKICAgICAgICAgICAgcHVibGlzaEZvcm1SdWxlczogewogICAgICAgICAgICAgICAgdHlwZTpbCiAgICAgICAgICAgICAgICAgICAge3JlcXVpcmVkOiB0cnVlLG1lc3NhZ2U6ICfor7fpgInmi6nnsbvlnosnLHRyaWdnZXI6ICdibHVyJ30KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB0YWdzOlsKICAgICAgICAgICAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsbWVzc2FnZTogJ+ivt+mAieaLqeiHs+WwkeS4gOenjeagh+etvicsdHJpZ2dlcjogJ2JsdXInfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIGZsYWc6WwogICAgICAgICAgICAgICAgICAgIHtyZXF1aXJlZDogdHJ1ZSxtZXNzYWdlOiAn6K+36YCJ5oup5paH56ug57G75Z6LJyx0cmlnZ2VyOiAnYmx1cid9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICB9LAogICAgICAgICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZQogICAgICAgIH0KICAgIH0sCiAgICBjcmVhdGVkKCl7CiAgICAgIGlmICh0eXBlb2YgdGhpcy4kcm91dGUucXVlcnkuYmxvZyAhPT0gJ3VuZGVmaW5lZCcpewogICAgICAgICAgdGhpcy5ibG9nID0gSlNPTi5wYXJzZSh0aGlzLiRyb3V0ZS5xdWVyeS5ibG9nKQogICAgICB9CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIC8vIOiOt+WPluWNmuWuouexu+Wei+WIl+ihqAogICAgICAgIGFzeW5jIGdldFR5cGVMaXN0KCkgewogICAgICAgICAgICBjb25zdCB7ZGF0YTogcmVzfSA9IGF3YWl0IHRoaXMuJGJsb2cuZ2V0KCcvYWRtaW4vZ2V0RnVsbFR5cGVMaXN0JykKICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKQogICAgICAgICAgICB0aGlzLnR5cGVMaXN0ID0gcmVzLmRhdGEKICAgICAgICB9LAogICAgICAgIC8vIOiOt+WPluWNmuWuouagh+etvuWIl+ihqAogICAgICAgIGFzeW5jIGdldFRhZ0xpc3QoKSB7CiAgICAgICAgICAgIGNvbnN0IHtkYXRhOiByZXN9ID0gYXdhaXQgdGhpcy4kYmxvZy5nZXQoJy9hZG1pbi9nZXRGdWxsVGFnTGlzdCcpCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcykKICAgICAgICAgICAgdGhpcy50YWdMaXN0ID0gcmVzLmRhdGEKICAgICAgICB9LAogICAgICAgIGFzeW5jIHN1Ym1pdCgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuYmxvZy5pZCE9PW51bGwpewogICAgICAgICAgICAgICAgY29uc3Qge2RhdGE6IHJlc30gPSBhd2FpdCB0aGlzLiRibG9nLnBvc3QoJy9hZG1pbi9ibG9ncycsIHsKICAgICAgICAgICAgICAgICAgICBibG9nOiB0aGlzLmJsb2cKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpCiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMucHVibGlzaERpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+S/ruaUueWNmuWuouaIkOWKn++8gScpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMucHVibGlzaERpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign5L+u5pS55Y2a5a6i5aSx6LSl77yBJykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0VHlwZUxpc3QoKQogICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRUYWdMaXN0KCkKICAgICAgICAgICAgICAgIHRoaXMucHVibGlzaERpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBhc3luYyBoYW5kbGVTdWNjZXNzKHJlcykgewogICAgICAgICAgICB0aGlzLmRpYWxvZ0ltYWdlVXJsID0gcmVzLmRhdGEKICAgICAgICB9LAogICAgICAgIHB1Ymxpc2hCbG9nKCkgewogICAgICAgICAgICB0aGlzLiRyZWZzLnB1Ymxpc2hGb3JtUmVmLnZhbGlkYXRlKCBhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm4KICAgICAgICAgICAgICAgIHRoaXMuYmxvZy5maXJzdFBpY3R1cmUgPSB0aGlzLmRpYWxvZ0ltYWdlVXJsCiAgICAgICAgICAgICAgICB0aGlzLmJsb2cudGFnSWRzID0gdGhpcy5wdWJsaXNoRm9ybS50YWdzLnRvU3RyaW5nKCkucmVwbGFjZSgvXFt8XS9nLCAnJyk7CiAgICAgICAgICAgICAgICB0aGlzLmJsb2cuZmxhZyA9IHRoaXMucHVibGlzaEZvcm0uZmxhZwogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5ibG9nLmNvbnRlbnQpCiAgICAgICAgICAgICAgICB0aGlzLmJsb2cudXNlciA9IEpTT04ucGFyc2Uod2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXInKSkKICAgICAgICAgICAgICAgIGNvbnN0IHtkYXRhOiByZXN9ID0gYXdhaXQgdGhpcy4kYmxvZy5wb3N0KCcvYWRtaW4vYmxvZ3MnLCB7CiAgICAgICAgICAgICAgICAgICAgYmxvZzogdGhpcy5ibG9nCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKQogICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnB1Ymxpc2hEaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Y+R5biD5Y2a5a6i5oiQ5Yqf77yBJykKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5wdWJsaXNoRGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCflj5HluIPljZrlrqLlpLHotKXvvIEnKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQoKICAgICAgICB9LAogICAgICAgIGhhbmRsZVJlbW92ZSgpIHsKICAgICAgICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9ICcnCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGZpbGUsIGZpbGVMaXN0KTsKICAgICAgICB9LAogICAgICAgIGhhbmRsZVBpY3R1cmVDYXJkUHJldmlldyhmaWxlKSB7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlLnVybDsKICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIHNldEJsb2dUeXBlKHJlcykgewogICAgICAgICAgICB0aGlzLmJsb2cudHlwZSA9IHRoaXMudHlwZUxpc3QuZmluZChpdGVtID0+IGl0ZW0uaWQgPT09IHJlcykKICAgICAgICB9LAogICAgICAgIGJhY2tQYWdlKCl7CiAgICAgICAgICAgIHRoaXMuJHJlZnMudXBsb2FkLmNsZWFyRmlsZXMoKQogICAgICAgICAgICB0aGlzLmJsb2cuZmlyc3RQaWN0dXJlID0gJycKICAgICAgICAgICAgdGhpcy5wdWJsaXNoRGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgICAgICAgICB0aGlzLiRyZWZzLnB1Ymxpc2hGb3JtUmVmLnJlc2V0RmllbGRzKCkKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["Blog_input.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Blog_input.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\n    <div>\n        <!--    面包屑导航区-->\n        <el-breadcrumb separator=\"/\">\n            <el-breadcrumb-item :to=\"{ path: '/admin' }\">首页</el-breadcrumb-item>\n            <el-breadcrumb-item>撰写博客</el-breadcrumb-item>\n        </el-breadcrumb>\n        <el-row :gutter=\"5\">\n            <el-col :span=\"21\">\n                <el-input placeholder=\"请输入文章标题\" v-model=\"blog.title\"></el-input>\n            </el-col>\n            <el-col :span=\"3\">\n                <el-button style=\"border-radius: 20px\" type=\"danger\" @click=\"submit\">发布文章</el-button>\n            </el-col>\n        </el-row>\n        <el-row>\n            <mavon-editor v-model=\"blog.content\" style=\"margin: 10px auto;min-height: 70vh\"/>\n        </el-row>\n        <el-row align=\"right\" type=\"flex\" justify=\"end\">\n\n        </el-row>\n        <el-dialog class=\"publish_dialog\" title=\"发布文章\" :visible.sync=\"publishDialogFormVisible\">\n            <el-form style=\"text-align: left\" ref=\"publishFormRef\" :model=\"publishForm\" :rules=\"publishFormRules\"\n                     class=\"publish_form\">\n                <el-form-item label=\"文章分类\" prop=\"type\">\n                    <el-select size=\"small\" v-model=\"publishForm.type\" placeholder=\"请选择文章分类\" style=\"margin-right: 10px\"\n                               @change=\"setBlogType\">\n                        <el-option v-for=\"type in typeList\" :label=\"type.name\" :value=\"type.id\" :key=\"type.id\"></el-option>\n                    </el-select>\n                    <el-button size=\"small\">+ 新建分类</el-button>\n                </el-form-item>\n                <el-form-item label=\"文章标签\" prop=\"tags\">\n                    <el-card shadow=\"never\" style=\"height: 120px; overflow: auto\">\n                        <el-checkbox-group v-model=\"publishForm.tags\">\n                            <el-checkbox v-for=\"tag in tagList\" :label=\"tag.id\" :key=\"tag.id\">{{tag.name}}</el-checkbox>\n                        </el-checkbox-group>\n                        <el-button size=\"mini\">+ 新建标签</el-button>\n                    </el-card>\n                </el-form-item>\n                <el-form-item label=\"文章类型\" prop=\"flag\">\n                    <el-select size=\"small\" v-model=\"publishForm.flag\">\n                        <el-option\n                                v-for=\"item in flags\"\n                                :key=\"item.value\"\n                                :label=\"item.label\"\n                                :value=\"item.value\">\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"文章首图\">\n                    <el-upload\n                            ref=\"upload\"\n                            action=\"http://hikari.top:8090/upload\"\n                            list-type=\"picture-card\"\n                            :limit=\"1\"\n                            :on-preview=\"handlePictureCardPreview\"\n                            :on-remove=\"handleRemove\"\n                            :on-success=\"handleSuccess\">\n                        <i class=\"el-icon-plus\"></i>\n                    </el-upload>\n                    <el-dialog :visible.sync=\"dialogVisible\">\n                        <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n                    </el-dialog>\n                </el-form-item>\n            </el-form>\n            <div slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"backPage\">取消</el-button>\n                <el-button type=\"primary\" @click=\"publishBlog\">发布文章</el-button>\n            </div>\n        </el-dialog>\n    </div>\n\n</template>\n\n<script>\nexport default {\n    data() {\n        return {\n            blog: {\n                id:null,\n                content: \"\",\n                flag: \"\",\n                title: \"\",\n                type: {},\n                tagIds: '',\n                firstPicture: \"\",\n                appreciation: 0,\n                user: {},\n                views: 0,\n                commentabled: true\n            },\n            dialogImageUrl:'',\n            flags: [\n                {value: \"原创\", label: \"原创\"},\n                {value: \"转载\", label: \"转载\"},\n                {value: \"翻译\", label: \"翻译\"}\n            ],\n            publishDialogFormVisible: false,\n            publishForm: {\n                // type: {},\n                tags: [],\n                flag:'原创'\n            },\n            typeList: [],\n            tagList: [],\n            publishFormRules: {\n                type:[\n                    {required: true,message: '请选择类型',trigger: 'blur'}\n                ],\n                tags:[\n                    {required: true,message: '请选择至少一种标签',trigger: 'blur'}\n                ],\n                flag:[\n                    {required: true,message: '请选择文章类型',trigger: 'blur'}\n                ],\n            },\n            dialogVisible: false\n        }\n    },\n    created(){\n      if (typeof this.$route.query.blog !== 'undefined'){\n          this.blog = JSON.parse(this.$route.query.blog)\n      }\n    },\n    methods: {\n        // 获取博客类型列表\n        async getTypeList() {\n            const {data: res} = await this.$blog.get('/admin/getFullTypeList')\n            // console.log(res)\n            this.typeList = res.data\n        },\n        // 获取博客标签列表\n        async getTagList() {\n            const {data: res} = await this.$blog.get('/admin/getFullTagList')\n            // console.log(res)\n            this.tagList = res.data\n        },\n        async submit() {\n            if (this.blog.id!==null){\n                const {data: res} = await this.$blog.post('/admin/blogs', {\n                    blog: this.blog\n                })\n                // console.log(res)\n                if (res.code === 200) {\n                    this.publishDialogFormVisible = false\n                    this.$router.go(-1);\n                    return this.$message.success('修改博客成功！')\n                } else {\n                    this.publishDialogFormVisible = false\n                    return this.$message.error('修改博客失败！')\n                }\n            } else {\n                await this.getTypeList()\n                await this.getTagList()\n                this.publishDialogFormVisible = true\n            }\n        },\n        async handleSuccess(res) {\n            this.dialogImageUrl = res.data\n        },\n        publishBlog() {\n            this.$refs.publishFormRef.validate( async valid => {\n                if (!valid) return\n                this.blog.firstPicture = this.dialogImageUrl\n                this.blog.tagIds = this.publishForm.tags.toString().replace(/\\[|]/g, '');\n                this.blog.flag = this.publishForm.flag\n                // console.log(this.blog.content)\n                this.blog.user = JSON.parse(window.sessionStorage.getItem('user'))\n                const {data: res} = await this.$blog.post('/admin/blogs', {\n                    blog: this.blog\n                })\n                // console.log(res)\n                if (res.code === 200) {\n                    this.publishDialogFormVisible = false\n                    return this.$message.success('发布博客成功！')\n                } else {\n                    this.publishDialogFormVisible = false\n                    return this.$message.error('发布博客失败！')\n                }\n            })\n\n        },\n        handleRemove() {\n            this.dialogImageUrl = ''\n            // console.log(file, fileList);\n        },\n        handlePictureCardPreview(file) {\n            this.dialogImageUrl = file.url;\n            this.dialogVisible = true;\n        },\n        setBlogType(res) {\n            this.blog.type = this.typeList.find(item => item.id === res)\n        },\n        backPage(){\n            this.$refs.upload.clearFiles()\n            this.blog.firstPicture = ''\n            this.publishDialogFormVisible = false\n            this.$refs.publishFormRef.resetFields()\n        }\n    }\n}\n</script>\n\n<style scoped lang=\"less\">\n    .el-form /deep/ .el-form-item__content {\n        line-height: 23px;\n    }\n\n    .el-card /deep/ .el-card__body {\n        padding: 10px;\n    }\n\n</style>"]}]}