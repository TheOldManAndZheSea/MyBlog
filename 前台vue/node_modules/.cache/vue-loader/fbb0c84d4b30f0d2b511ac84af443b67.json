{"remainingRequest":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\login\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\login\\Login.vue","mtime":1628309540000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwU3RhdGV9IGZyb20gJ3Z1ZXgnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHVzZXI6ewogICAgICAgICAgICAgICAgdXNlcm5hbWU6JycsCiAgICAgICAgICAgICAgICBwYXNzd29yZDonJywKICAgICAgICAgICAgICAgIGxvZ2luUHJvdmluY2U6J+mZleilv+ecgScsCiAgICAgICAgICAgICAgICBsb2dpbkNpdHk6J+WSuOmYs+W4gicsCiAgICAgICAgICAgICAgICBsb2dpbkxhdDozNC4yNywgLy/nuqzluqYKICAgICAgICAgICAgICAgIGxvZ2luTG5nOjEwOC4wOCwgLy/nu4/luqYKICAgICAgICAgICAgfSwKICAgICAgICAgICAgLy8g6KGo5Y2V5pWw5o2u57uR5a6a5a+56LGhCiAgICAgICAgICAgIGxvZ2luRm9ybTogewogICAgICAgICAgICAgICAgdXNlcm5hbWU6ICcnLAogICAgICAgICAgICAgICAgcGFzc3dvcmQ6ICcnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIC8vIOihqOWNlemqjOivgeinhOWImeWvueixoQogICAgICAgICAgICBsb2dpbkZvcm1SdWxlczogewogICAgICAgICAgICAgICAgLy8g6aqM6K+B55So5oi35piv5ZCm5ZCI5rOVCiAgICAgICAgICAgICAgICB1c2VybmFtZTogWwogICAgICAgICAgICAgICAgICAgIC8vIOW/heWhq++8jOaPkOekuua2iOaBr++8jOm8oOagh+eEpueCuea2iOWkseaXtuinpuWPkQogICAgICAgICAgICAgICAgICAgIHtyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeeUqOaIt+WQjSIsIHRyaWdnZXI6ICJibHVyIn0sCiAgICAgICAgICAgICAgICAgICAge21pbjogMiwgbWF4OiAxMCwgbWVzc2FnZTogIumVv+W6puWcqDItMTDkuKrlrZfnrKbkuYvpl7QifQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIC8vIOmqjOivgeWvhueggeaYr+WQpuWQiOazlQogICAgICAgICAgICAgICAgcGFzc3dvcmQ6IFsKICAgICAgICAgICAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fovpPlhaXlr4bnoIEiLCB0cmlnZ2VyOiAiYmx1ciJ9LAogICAgICAgICAgICAgICAgICAgIHttaW46IDYsIG1heDogMTAsIG1lc3NhZ2U6ICLplb/luqblnKggNiDliLAgMTAg5Liq5a2X56ymIiwgdHJpZ2dlcjogImJsdXIifQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9LAogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDp7CiAgICAgICAuLi5tYXBTdGF0ZShbCiAgICAgICAgICAgJ2xvZ2luRm9ybVZpc2lhYmxlJwogICAgICAgXSkKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgcmVzZXRMb2dpbkZvcm0oKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnY2FuY2VsTEZWJykKICAgICAgICAgICAgdGhpcy4kcmVmcy5sb2dpbkZvcm1SZWYucmVzZXRGaWVsZHMoKQogICAgICAgIH0sCiAgICAgICAgLy8g55So5oi355m75b2VCiAgICAgICAgdXNlckxvZ2luKCkgewogICAgICAgICAgICB0aGlzLiRyZWZzLmxvZ2luRm9ybVJlZi52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm47CiAgICAgICAgICAgICAgICB0aGlzLnVzZXIudXNlcm5hbWUgPSB0aGlzLmxvZ2luRm9ybS51c2VybmFtZQogICAgICAgICAgICAgICAgdGhpcy51c2VyLnBhc3N3b3JkID0gdGhpcy4kbWQ1KHRoaXMubG9naW5Gb3JtLnBhc3N3b3JkKQogICAgICAgICAgICAgICAgbGV0IGxvY2FsID0gYXdhaXQgdGhpcy5nZXRMb2NhbENpdHkoKQogICAgICAgICAgICAgICAgdGhpcy51c2VyLmxvZ2luUHJvdmluY2UgPSBsb2NhbC5yZXN1bHQuYWRfaW5mby5wcm92aW5jZQogICAgICAgICAgICAgICAgdGhpcy51c2VyLmxvZ2luQ2l0eSA9IGxvY2FsLnJlc3VsdC5hZF9pbmZvLmNpdHkKICAgICAgICAgICAgICAgIHRoaXMudXNlci5sb2dpbkxhdCA9IGxvY2FsLnJlc3VsdC5sb2NhdGlvbi5sYXQKICAgICAgICAgICAgICAgIHRoaXMudXNlci5sb2dpbkxuZyA9IGxvY2FsLnJlc3VsdC5sb2NhdGlvbi5sbmcKICAgICAgICAgICAgICAgIGNvbnN0IHtkYXRhOiByZXN9ID0gYXdhaXQgdGhpcy4kYmxvZy5wb3N0KCcvbG9naW4nLCB7CiAgICAgICAgICAgICAgICAgICAgdXNlcjp0aGlzLnVzZXIKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlICE9PSAyMDApIHJldHVybiB0aGlzLiRtZXNzYWdlKHttZXNzYWdlOiAn55So5oi35ZCN5oiW5a+G56CB6ZSZ6K+vJywgdHlwZTogJ2Vycm9yJywgb2Zmc2V0OiA4MH0pCiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHttZXNzYWdlOiAn55m75b2V5oiQ5YqfJywgdHlwZTogJ3N1Y2Nlc3MnLCBvZmZzZXQ6IDgwfSk7CiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLmxvZ2luRm9ybVJlZi5yZXNldEZpZWxkcygpCiAgICAgICAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgidG9rZW4iLCBKU09OLnN0cmluZ2lmeShyZXMuZGF0YS50b2tlbikpOwogICAgICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oInVzZXIiLCBKU09OLnN0cmluZ2lmeShyZXMuZGF0YS51c2VyKSk7CiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2dldFVzZXJJbmZvJykKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnY2FuY2VsTEZWJykKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGdldExvY2FsQ2l0eSgpewogICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgIGtleTogJ0lVVEJaLVVIQUtVLVBENlZJLUJaRUVZLU4zWVQzLVNDQjZKJywKICAgICAgICAgICAgICAgIG91dHB1dDonanNvbnAnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IHVybCA9ICdodHRwczovL2FwaXMubWFwLnFxLmNvbS93cy9sb2NhdGlvbi92MS9pcCcKICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kanNvbnAodXJsLCBkYXRhKSkKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kanNvbnAodXJsLCBkYXRhKQogICAgICAgICAgICByZXR1cm4gcmVzCiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components/login","sourcesContent":["<template>\n    <el-dialog class=\"login_dialog\" title=\"请登录\" :visible.sync=\"loginFormVisiable\" @close=\"resetLoginForm\" width=\"400px\" center>\n        <el-form ref=\"loginFormRef\" :model=\"loginForm\" :rules=\"loginFormRules\" label-width=\"60px\" class=\"login_form\">\n            <!--        用户名-->\n            <el-form-item prop=\"username\" label=\"账号\">\n                <el-input v-model=\"loginForm.username\">\n                </el-input>\n            </el-form-item>\n            <!--        密码-->\n            <el-form-item prop=\"password\" label=\"密码\">\n                <el-input type=\"password\" v-model=\"loginForm.password\"></el-input>\n            </el-form-item>\n            <el-form-item style=\"text-align: right\">\n                <el-button @click=\"resetLoginForm\">取消</el-button>\n                <el-button type=\"primary\" @click=\"userLogin\">登录</el-button>\n            </el-form-item>\n        </el-form>\n    </el-dialog>\n</template>\n\n<script>\nimport {mapState} from 'vuex'\n\nexport default {\n    data() {\n        return {\n            user:{\n                username:'',\n                password:'',\n                loginProvince:'陕西省',\n                loginCity:'咸阳市',\n                loginLat:34.27, //纬度\n                loginLng:108.08, //经度\n            },\n            // 表单数据绑定对象\n            loginForm: {\n                username: '',\n                password: ''\n            },\n            // 表单验证规则对象\n            loginFormRules: {\n                // 验证用户是否合法\n                username: [\n                    // 必填，提示消息，鼠标焦点消失时触发\n                    {required: true, message: \"请输入用户名\", trigger: \"blur\"},\n                    {min: 2, max: 10, message: \"长度在2-10个字符之间\"}\n                ],\n                // 验证密码是否合法\n                password: [\n                    {required: true, message: \"请输入密码\", trigger: \"blur\"},\n                    {min: 6, max: 10, message: \"长度在 6 到 10 个字符\", trigger: \"blur\"}\n                ]\n            },\n        }\n    },\n    computed:{\n       ...mapState([\n           'loginFormVisiable'\n       ])\n    },\n    methods: {\n        resetLoginForm() {\n            this.$store.commit('cancelLFV')\n            this.$refs.loginFormRef.resetFields()\n        },\n        // 用户登录\n        userLogin() {\n            this.$refs.loginFormRef.validate(async valid => {\n                if (!valid) return;\n                this.user.username = this.loginForm.username\n                this.user.password = this.$md5(this.loginForm.password)\n                let local = await this.getLocalCity()\n                this.user.loginProvince = local.result.ad_info.province\n                this.user.loginCity = local.result.ad_info.city\n                this.user.loginLat = local.result.location.lat\n                this.user.loginLng = local.result.location.lng\n                const {data: res} = await this.$blog.post('/login', {\n                    user:this.user\n                });\n                if (res.code !== 200) return this.$message({message: '用户名或密码错误', type: 'error', offset: 80})\n                this.$message({message: '登录成功', type: 'success', offset: 80});\n                this.$refs.loginFormRef.resetFields()\n                window.sessionStorage.setItem(\"token\", JSON.stringify(res.data.token));\n                window.sessionStorage.setItem(\"user\", JSON.stringify(res.data.user));\n                this.$store.commit('getUserInfo')\n                this.$store.commit('cancelLFV')\n            })\n        },\n        async getLocalCity(){\n            let data = {\n                key: 'IUTBZ-UHAKU-PD6VI-BZEEY-N3YT3-SCB6J',\n                output:'jsonp'\n            }\n            let url = 'https://apis.map.qq.com/ws/location/v1/ip'\n            // console.log(this.$jsonp(url, data))\n            const res = await this.$jsonp(url, data)\n            return res\n        }\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n    .login_form {\n        width: 100%;\n        padding: 0 20px;\n        box-sizing: border-box;\n    }\n\n    .btns {\n        display: flex;\n        justify-content: flex-end;\n    }\n\n    .login_dialog{\n        opacity: 1;\n    }\n\n</style>\n"]}]}