{"remainingRequest":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\Message.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\Message.vue","mtime":1628309540000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwU3RhdGV9IGZyb20gJ3Z1ZXgnCmV4cG9ydCBkZWZhdWx0IHsKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcGljTGlzdDogW10sCiAgICAgICAgICAgIGVkaXRpbmc6IGZhbHNlLAogICAgICAgICAgICBtZXNzYWdlTGlzdDogW10sCiAgICAgICAgICAgIC8vIHVzZXJJbmZvOiBudWxsLAogICAgICAgICAgICBtZXNzYWdlOnsKICAgICAgICAgICAgICAgIHVzZXJJZDotMSwKICAgICAgICAgICAgICAgIGNvbnRlbnQ6JycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbWVzc2FnZUZvcm06ewogICAgICAgICAgICAgICAgY29udGVudDonJwogICAgICAgICAgICB9LAogICAgICAgICAgICBtZXNzYWdlRm9ybVJ1bGVzOnsKICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFsKICAgICAgICAgICAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLnlZnoqIDlhoXlrrnkuI3og73kuLrnqbrvvIEifSwKICAgICAgICAgICAgICAgICAgICB7bWluOiAwLCBtYXg6IDEwMCwgbWVzc2FnZTogIueVmeiogOWGheWuueS4jei2hei/hzEwMOWtl++8gSJ9CiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgIH0sCiAgICAgICAgfQogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdGhpcy5nZXRNZXNzYWdlTGlzdCgpCiAgICB9LAogICAgY29tcHV0ZWQ6ewogICAgICAgIC4uLm1hcFN0YXRlKFsKICAgICAgICAgICAgJ3VzZXJJbmZvJywKICAgICAgICAgICAgJ2FkbWluaXN0cmF0b3InCiAgICAgICAgXSkKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgLy8g55WZ6KiA5Y+R6KGoCiAgICAgICAgcHVibGlzaCgpewogICAgICAgICAgICB0aGlzLiRyZWZzLm1lc3NhZ2VGb3JtUmVmLnZhbGlkYXRlKCAgYXN5bmMgdmFsaWQgPT4gewogICAgICAgICAgICAgICAgaWYgKCF2YWxpZCkgcmV0dXJuCiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2UuY29udGVudCA9IHRoaXMubWVzc2FnZUZvcm0uY29udGVudAogICAgICAgICAgICAgICAgaWYgKHRoaXMudXNlckluZm8gPT09IG51bGwpewogICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZS51c2VySWQgPSAtMQogICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZS5uaWNrbmFtZSA9ICLljL/lkI3nlKjmiLciCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlLmF2YXRhciA9ICcnCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZS51c2VySWQgPSB0aGlzLnVzZXJJbmZvLnVzZXJJZAogICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZS5uaWNrbmFtZSA9IHRoaXMudXNlckluZm8ubmlja25hbWUKICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2UuYXZhdGFyID0gdGhpcy51c2VySW5mby5hdmF0YXIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHtkYXRhOiByZXN9ID0gYXdhaXQgdGhpcy4kYmxvZy5wb3N0KCcvbWVzc2FnZXMnLHsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOnRoaXMubWVzc2FnZQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRNZXNzYWdlTGlzdCgpCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7bWVzc2FnZTogIueVmeiogOWPkeihqOaIkOWKnyIsIHR5cGU6ICdzdWNjZXNzJywgb2Zmc2V0OiA4MH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHttZXNzYWdlOiAi55WZ6KiA5Y+R6KGo5aSx6LSl77yBIiwgdHlwZTogJ2Vycm9yJywgb2Zmc2V0OiA4MH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQoKCgogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZ2V0QWxsUGljTGlzdCgpIHsKICAgICAgICAgICAgY29uc3Qge2RhdGE6IHJlc30gPSBhd2FpdCB0aGlzLiRwaWN0dXJlLmdldCgnL3BpY19wYXRocy9nZXRfYWxsLycpCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcykKICAgICAgICAgICAgdGhpcy5waWNMaXN0ID0gcmVzCiAgICAgICAgfSwKCiAgICAgICAgLy8g6I635Y+W55WZ6KiA5YiX6KGoCiAgICAgICAgYXN5bmMgZ2V0TWVzc2FnZUxpc3QoKSB7CiAgICAgICAgICAgIGNvbnN0IHtkYXRhOiByZXN9ID0gYXdhaXQgdGhpcy4kYmxvZy5nZXQoJy9tZXNzYWdlcycpCiAgICAgICAgICAgIHRoaXMubWVzc2FnZUxpc3QgPSByZXMuZGF0YS5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgICAgICAgICByZXR1cm4gYi5jcmVhdGVUaW1lLmxvY2FsZUNvbXBhcmUoYS5jcmVhdGVUaW1lKQogICAgICAgICAgICB9KQogICAgICAgIH0sCgogICAgfSwKfQo="},{"version":3,"sources":["Message.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Message.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <el-container style=\"opacity: 0.9\" class=\"message\">\n        <el-card class=\"animate__animated animate__fadeInLeft publish\">\n            <div class=\"author\">\n                <el-avatar v-if=\"userInfo===null\" icon=\"el-icon-user-solid\" size=\"large\" style=\"background-color: #666\"></el-avatar>\n                <el-avatar v-else :src=\"userInfo.avatar\" size=\"large\"></el-avatar>\n                <div>\n                    <div class=\"nkname\">\n                        <span class=\"name\" v-if=\"userInfo===null\">匿名用户</span>\n                        <span class=\"name\" v-else>{{userInfo.nickname}} </span>\n                    </div>\n                </div>\n            </div>\n            <el-form :model=\"messageForm\" :rules=\"messageFormRules\" ref=\"messageFormRef\">\n                <el-form-item prop=\"content\">\n                    <el-input :rows=\"5\" v-model=\"messageForm.content\" type=\"textarea\" placeholder=\"请输入你的留言\"></el-input>\n                </el-form-item>\n                <el-form-item style=\"text-align: right\">\n                    <el-button type=\"primary\" @click=\"publish\">点击发表</el-button>\n                </el-form-item>\n            </el-form>\n        </el-card>\n\n        <el-card v-if=\"messageList.length>0\" class=\"animate__animated animate__fadeInLeft\">\n            <ul style=\"padding: 0;\" class=\"comment-list\">\n                <li class=\"comment\" v-for=\"ms in messageList\" :key=\"ms.id\">\n                    <el-avatar v-if=\"ms.avatar!==''\" :src=\"ms.avatar\" ></el-avatar>\n                    <el-avatar v-else  icon=\"el-icon-user-solid\"></el-avatar>\n                    <div class=\"content\">\n                        <div style=\"display: flex;justify-content: space-between;width: 100%\">\n                            <div class=\"nkname\">\n                                <span class=\"name\">{{ms.nickname}} </span>\n                                <span class=\"date\">{{ms.createTime | dataFormat3}}</span>\n                            </div>\n                        </div>\n                        <p class=\"reply\">{{ms.content}}</p>\n                    </div>\n                    <!--                    {{cmt}}-->\n                </li>\n            </ul>\n        </el-card>\n    </el-container>\n</template>\n\n<script>\nimport {mapState} from 'vuex'\nexport default {\n    data() {\n        return {\n            picList: [],\n            editing: false,\n            messageList: [],\n            // userInfo: null,\n            message:{\n                userId:-1,\n                content:''\n            },\n            messageForm:{\n                content:''\n            },\n            messageFormRules:{\n                content: [\n                    {required: true, message: \"留言内容不能为空！\"},\n                    {min: 0, max: 100, message: \"留言内容不超过100字！\"}\n                ]\n            },\n        }\n    },\n    created() {\n        this.getMessageList()\n    },\n    computed:{\n        ...mapState([\n            'userInfo',\n            'administrator'\n        ])\n    },\n    methods: {\n        // 留言发表\n        publish(){\n            this.$refs.messageFormRef.validate(  async valid => {\n                if (!valid) return\n                this.message.content = this.messageForm.content\n                if (this.userInfo === null){\n                    this.message.userId = -1\n                    this.message.nickname = \"匿名用户\"\n                    this.message.avatar = ''\n                } else {\n                    this.message.userId = this.userInfo.userId\n                    this.message.nickname = this.userInfo.nickname\n                    this.message.avatar = this.userInfo.avatar\n                }\n                const {data: res} = await this.$blog.post('/messages',{\n                    message:this.message\n                })\n                if (res.code === 200) {\n                    this.getMessageList()\n                    this.$message({message: \"留言发表成功\", type: 'success', offset: 80});\n                } else {\n                    this.$message({message: \"留言发表失败！\", type: 'error', offset: 80});\n                }\n            })\n\n\n\n        },\n        async getAllPicList() {\n            const {data: res} = await this.$picture.get('/pic_paths/get_all/')\n            // console.log(res)\n            this.picList = res\n        },\n\n        // 获取留言列表\n        async getMessageList() {\n            const {data: res} = await this.$blog.get('/messages')\n            this.messageList = res.data.sort((a, b) => {\n                return b.createTime.localeCompare(a.createTime)\n            })\n        },\n\n    },\n}\n</script>\n\n<style scoped lang=\"less\">\n    .el-container{\n        display: block;\n    }\n\n    .publish{\n        margin-bottom: 20px;\n    }\n\n    .author {\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n        width: 100%;\n        margin-bottom: 20px;\n        .nkname{\n            margin: 10px;\n        }\n    }\n\n    .img {\n        width: 300px;\n        margin: 20px;\n    }\n\n    .comment {\n        border-bottom: 1px dashed #ccc;\n        margin: 30px 0;\n        display: flex;\n    }\n\n    /*.el-avatar {*/\n    /*    width: 35px;*/\n    /*    height: 35px;*/\n    /*    border: 2px solid white;*/\n    /*    box-shadow: 0 0 10px 2px rgba(0, 0, 0, .06);*/\n    /*    flex-shrink: 0;*/\n    /*}*/\n\n    .content {\n        text-align: left;\n        font-size: 14px;\n        flex-grow: 1;\n\n        .nkname {\n            margin-left: 10px;\n            max-width: 530px;\n            overflow: hidden;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n\n            .rp, .date {\n                color: #999;\n                margin-left: 10px;\n            }\n\n            .blog {\n                color: #349edf;\n                margin-left: 10px;\n            }\n        }\n\n        .reply {\n            margin-left: 10px;\n        }\n\n        .op {\n            color: #ddd;\n            font-weight: lighter;\n\n            .rep {\n                color: #349edf;\n            }\n\n            .del {\n                color: red;\n            }\n        }\n\n        .op:hover {\n            cursor: pointer;\n        }\n    }\n</style>"]}]}