{"remainingRequest":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\admin\\Essays.vue?vue&type=style&index=0&id=876fa0f4&scoped=true&lang=css&","dependencies":[{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\admin\\Essays.vue","mtime":1648525190918},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5lc3NheS1jb2xvciB7CiAgd2lkdGg6IDMwcHg7CiAgaGVpZ2h0OiAzMHB4OwogIGJvcmRlci1yYWRpdXM6IDk5OTlweDsKICBib3JkZXI6IDFweCBzb2xpZCB3aGl0ZTsKfQoKLmNhcmQ6aG92ZXIgewogIGN1cnNvcjogcG9pbnRlcjsKfQo="},{"version":3,"sources":["Essays.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoMA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Essays.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\n  <div>\n    <!--    面包屑导航区-->\n    <el-breadcrumb separator=\"/\">\n      <el-breadcrumb-item :to=\"{ path: '/admin' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>随笔管理</el-breadcrumb-item>\n    </el-breadcrumb>\n\n    <el-card shadow=\"hover\">\n      <el-tabs v-model=\"activeName\" type=\"card\" @tab-click=\"handleClick\">\n        <el-tab-pane label=\"新建随笔\" name=\"first\">\n          <el-form label-position=\"left\" label-width=\"80px\" style=\"text-align: left\" ref=\"publishFormRef\"\n                   :model=\"publishForm\"\n                   class=\"publish_form\">\n            <el-form-item label=\"标题\" prop=\"title\">\n              <el-input v-model=\"publishForm.title\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"色彩\" prop=\"color\">\n              <el-color-picker size=\"small\" show-alpha v-model=\"publishForm.color\"></el-color-picker>\n            </el-form-item>\n            <el-form-item label=\"内容\" prop=\"content\">\n              <mavon-editor v-model=\"publishForm.content\"\n                            ref=\"md\"\n                            @imgAdd=\"imgAdd\"\n                            @imgDel=\"imgDel\"\n                            style=\"margin: 10px auto;min-height: 70vh\"/>\n            </el-form-item>\n            <el-form-item style=\"text-align: center\">\n              <el-button type=\"primary\" @click=\"publishAssay\">发布</el-button>\n            </el-form-item>\n          </el-form>\n        </el-tab-pane>\n        <el-tab-pane label=\"随笔管理\" name=\"second\">\n          <el-table :data=\"essayList\" border stripe>\n            <el-table-column type=\"index\"></el-table-column>\n            <el-table-column label=\"随笔标题\" prop=\"title\"></el-table-column>\n            <el-table-column label=\"边框颜色\" prop=\"color\">\n              <template slot-scope=\"scope\">\n                <el-tag :color=\"scope.row.color\" class=\"essay-color\"></el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"发布时间\" prop=\"createTime\">\n              <template slot-scope=\"scope\">\n                {{scope.row.createTime | dataFormat }}\n              </template>\n            </el-table-column>\n            <el-table-column label=\"操作\">\n              <template slot-scope=\"scope\">\n                <!--            修改按钮-->\n                <el-button\n                        type=\"primary\"\n                        icon=\"el-icon-edit\"\n                        size=\"mini\"\n                        circle\n                        @click=\"editByid(scope.row)\"\n                ></el-button>\n                <!--            删除按钮-->\n                <el-button\n                        type=\"danger\"\n                        icon=\"el-icon-delete\"\n                        size=\"mini\"\n                        circle\n                        @click=\"removeById(scope.row.id)\"\n                ></el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-tab-pane>\n      </el-tabs>\n    </el-card>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      essay: {\n        id: null,\n        content: \"\",\n        title: \"\",\n        color: \"\",\n        createTime: \"\"\n      },\n      publishDialogFormVisible: false,\n      publishForm: {\n        color: 'rgba(0, 0, 0, 1)'\n      },\n      dialogVisible: false,\n      activeName: 'first',\n      essayList: [],\n      vis: false,\n\n    }\n  },\n  created() {\n    this.getEssayList()\n  },\n  methods: {\n    // 将图片上传到服务器，返回的地址替换到md中\n    async imgAdd(pos, $file) {\n      // console.log($file)\n      let formdata = new FormData();\n      formdata.append('file', $file);\n      const {data: res} = await this.$blog.post('/upload', formdata)\n      if (res.code === 200) {\n        this.$refs.md.$img2Url(pos, res.data)\n      }\n    },\n    // 删除不需要的图片\n    async imgDel(pos) {\n      // console.log(pos[0])\n      let len = pos[0].split('/').length\n      let filename = pos[0].split('/')[len - 1]\n    },\n    // 获取随笔列表\n    async getEssayList() {\n      const {data: res} = await this.$blog.get('/admin/essays')\n      if (res.code === 200) {\n        this.essayList = res.data.sort((a, b) => {\n          return b.createTime.localeCompare(a.createTime)\n        })\n        this.essayList.forEach(item => {\n          item.vis = false\n        })\n      }\n    },\n    backPage() {\n      this.$refs.upload.clearFiles()\n      this.blog.firstPicture = ''\n      this.publishDialogFormVisible = false\n      this.$refs.publishFormRef.resetFields()\n    },\n    // 发布随笔\n    async publishAssay() {\n      if (this.publishForm.id !== null) {\n        this.essay.id = this.publishForm.id\n        console.log(this.essay.id)\n      }\n      this.essay.image = this.dialogImageUrl\n      this.essay.title = this.publishForm.title\n      this.essay.content = this.publishForm.content\n      this.essay.color = this.publishForm.color\n      // console.log(this.essay)\n      const {data: res} = await this.$blog.post('/admin/essay', {\n        essay: this.essay\n      })\n      // console.log(res)\n      if (res.code === 200) {\n        this.publishDialogFormVisible = false\n        return this.$message.success('发布随笔成功！')\n      } else {\n        this.publishDialogFormVisible = false\n        return this.$message.error('发布随笔失败！')\n      }\n    },\n    // 点击tab时的事件\n    handleClick(tab, event) {\n      if (tab.name === 'second') {\n        this.getEssayList()\n      }\n    },\n    // 删除随笔\n    async removeById(id) {\n      // 弹出对话框\n      const confirmResult = await this.$confirm(\n          '确定要删除该随笔吗',\n          '提示',\n          {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }\n      ).catch(err => err)\n      if (confirmResult !== 'confirm') {\n        return this.$message.info('已取消删除')\n      }\n      const {data: res} = await this.$blog.get(`/admin/essay/${id}/delete`)\n      if (res.code === 200) {\n        await this.getEssayList()\n        return this.$message.success('项目删除成功！')\n      } else {\n        return this.$message.error('项目删除失败！')\n      }\n    },\n    // 编辑随笔\n    editByid(row) {\n      console.log(row)\n      this.publishForm = row\n      this.activeName = 'first'\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .essay-color {\n    width: 30px;\n    height: 30px;\n    border-radius: 9999px;\n    border: 1px solid white;\n  }\n\n  .card:hover {\n    cursor: pointer;\n  }\n</style>"]}]}