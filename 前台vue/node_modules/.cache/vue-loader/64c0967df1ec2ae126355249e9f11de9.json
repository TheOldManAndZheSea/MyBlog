{"remainingRequest":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\login\\Register.vue?vue&type=style&index=0&id=0710bf8e&lang=less&scoped=true&","dependencies":[{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\login\\Register.vue","mtime":1628309540000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5hdmF0YXItdXBsb2FkZXIgLmVsLXVwbG9hZCB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBvdmVyZmxvdzogaGlkZGVuOwp9CgouYXZhdGFyLXVwbG9hZGVyIC5lbC11cGxvYWQ6aG92ZXIgewogICAgYm9yZGVyLWNvbG9yOiAjNDA5RUZGOwp9CgouYXZhdGFyLXVwbG9hZGVyLWljb24gewogICAgYm9yZGVyOiAxcHggZGFzaGVkICNkOWQ5ZDk7CiAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICBmb250LXNpemU6IDI4cHg7CiAgICBjb2xvcjogIzhjOTM5ZDsKICAgIHdpZHRoOiAxMDBweDsKICAgIGhlaWdodDogMTAwcHg7CiAgICBsaW5lLWhlaWdodDogMTAwcHg7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7Cn0KCi5hdmF0YXIgewogICAgd2lkdGg6IDEwMHB4OwogICAgaGVpZ2h0OiAxMDBweDsKICAgIGRpc3BsYXk6IGJsb2NrOwp9CgoubG9naW5fZm9ybSB7CiAgICB3aWR0aDogMTAwJTsKICAgIHBhZGRpbmc6IDAgMjBweDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Cn0KCi5idG5zIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOwp9CgoubG9naW5fZGlhbG9nIHsKICAgIG9wYWNpdHk6IDE7Cn0KCg=="},{"version":3,"sources":["Register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6JA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Register.vue","sourceRoot":"src/components/login","sourcesContent":["<template>\n    <el-dialog class=\"dialog\" title=\"请登录\" :visible.sync=\"registorFormVisiable\" @close=\"resetForm\" width=\"400px\" center>\n        <el-form ref=\"FormRef\" :model=\"Form\" :rules=\"FormRules\" class=\"form\" label-width=\"80px\" label-position=\"left\">\n            <!--        昵称-->\n            <el-form-item label=\"昵称\" prop=\"nickname\">\n                <el-input v-model=\"Form.nickname\"></el-input>\n            </el-form-item>\n            <!--        用户名-->\n            <el-form-item label=\"用户名\" prop=\"username\">\n                <el-input v-model=\"Form.username\"></el-input>\n            </el-form-item>\n            <!--        密码-->\n            <el-form-item label=\"密码\" prop=\"password\">\n                <el-input type=\"password\" v-model=\"Form.password\"></el-input>\n            </el-form-item>\n            <!--        密码-->\n            <el-form-item label=\"邮箱\" prop=\"email\">\n                <el-input v-model=\"Form.email\"></el-input>\n            </el-form-item>\n            <!--        头像-->\n            <el-form-item prop=\"avatar\" label=\"头像\">\n                <el-upload\n                        class=\"avatar-uploader\"\n                        ref=\"upload\"\n                        action=\"http://hikari.top:8090/upload\"\n                        :limit=\"1\"\n                        :show-file-list=\"false\"\n                        :on-remove=\"handleRemove\"\n                        :on-success=\"handleSuccess\"\n                        :before-upload=\"beforeAvatarUpload\">\n                    <img v-if=\"dialogImageUrl\" :src=\"dialogImageUrl\" class=\"avatar\">\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                </el-upload>\n            </el-form-item>\n            <el-form-item style=\"text-align: right\">\n                <el-button @click=\"resetForm\">取消</el-button>\n                <el-button type=\"primary\" @click=\"userRegister\">登录</el-button>\n            </el-form-item>\n        </el-form>\n    </el-dialog>\n</template>\n\n<script>\nimport {mapState} from 'vuex'\n\nexport default {\n    data() {\n        return {\n            user: {\n                username: '',\n                nickname: '',\n                avatar: '',\n                email: '',\n                password: '',\n                type: 0\n            },\n            // 表单数据绑定对象\n            Form: {\n                nickname: '',\n                username: '',\n                password: '',\n                email: ''\n            },\n            // 表单验证规则对象\n            FormRules: {\n                // 验证用户是否合法\n                username: [\n                    // 必填，提示消息，鼠标焦点消失时触发\n                    {required: true, message: \"请输入用户名\", trigger: \"blur\"},\n                    {min: 2, max: 10, message: \"长度在2-10个字符之间\"}\n                ],\n                // 验证用户是否合法\n                nickname: [\n                    // 必填，提示消息，鼠标焦点消失时触发\n                    {required: true, message: \"请输入昵称\", trigger: \"blur\"},\n                    {min: 2, max: 10, message: \"长度在2-10个字符之间\"}\n                ],\n                // 验证密码是否合法\n                password: [\n                    {required: true, message: \"请输入密码\", trigger: \"blur\"},\n                    {min: 6, max: 10, message: \"长度在 6 到 10 个字符\", trigger: \"blur\"}\n                ],\n            },\n            dialogImageUrl: ''\n        }\n    },\n    computed: {\n        ...mapState([\n            'registorFormVisiable'\n        ])\n    },\n    methods: {\n        async handleSuccess(res) {\n            // console.log(res.data)\n            this.dialogImageUrl = res.data\n        },\n        handleRemove() {\n            this.dialogImageUrl = ''\n        },\n        handlePictureCardPreview(file) {\n            this.dialogImageUrl = file.url;\n        },\n        resetForm() {\n            this.$store.commit('cancelRFV')\n            this.$refs.FormRef.resetFields()\n            this.dialogImageUrl = ''\n        },\n        beforeAvatarUpload(file) {\n            const isLt2M = file.size / 1024 / 1024 < 2;\n            if (!isLt2M) {\n                this.$message.error('上传头像图片大小不能超过 2MB!');\n            }\n            return isLt2M;\n        },\n        // 用户登录\n        userRegister() {\n            this.$refs.FormRef.validate(async valid => {\n                if (!valid) return;\n                this.user.username = this.Form.username\n                this.user.nickname = this.Form.nickname\n                this.user.email = this.Form.email\n                this.user.avatar = this.dialogImageUrl\n                this.user.password = this.$md5(this.Form.password)\n                let local = await this.getLocalCity()\n                this.user.loginProvince = local.result.ad_info.province\n                this.user.loginCity = local.result.ad_info.city\n                this.user.loginLat = local.result.location.lat\n                this.user.loginLng = local.result.location.lng\n                const {data: res} = await this.$blog.post('/registor', {\n                    user: this.user\n                })\n                if (res.code !== 200) return this.$message.error(\"注册失败\")\n                // console.log(res)\n                this.$refs.FormRef.resetFields()\n                this.$message({message: '注册成功', type: 'success', offset: 80});\n                window.sessionStorage.setItem(\"token\", JSON.stringify(res.data.token));\n                window.sessionStorage.setItem(\"user\", JSON.stringify(res.data.user));\n                this.$store.commit('getUserInfo')\n                this.$store.commit('cancelRFV')\n            })\n        },\n        async getLocalCity(){\n            let data = {\n                key: 'IUTBZ-UHAKU-PD6VI-BZEEY-N3YT3-SCB6J',\n                output:'jsonp'\n            }\n            let url = 'https://apis.map.qq.com/ws/location/v1/ip'\n            // console.log(this.$jsonp(url, data))\n            const res = await this.$jsonp(url, data)\n            return res\n        }\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n    .avatar-uploader .el-upload {\n        cursor: pointer;\n        position: relative;\n        overflow: hidden;\n    }\n\n    .avatar-uploader .el-upload:hover {\n        border-color: #409EFF;\n    }\n\n    .avatar-uploader-icon {\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        font-size: 28px;\n        color: #8c939d;\n        width: 100px;\n        height: 100px;\n        line-height: 100px;\n        text-align: center;\n    }\n\n    .avatar {\n        width: 100px;\n        height: 100px;\n        display: block;\n    }\n\n    .login_form {\n        width: 100%;\n        padding: 0 20px;\n        box-sizing: border-box;\n    }\n\n    .btns {\n        display: flex;\n        justify-content: flex-end;\n    }\n\n    .login_dialog {\n        opacity: 1;\n    }\n\n</style>\n"]}]}