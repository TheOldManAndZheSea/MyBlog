{"remainingRequest":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\login\\Register.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\src\\components\\login\\Register.vue","mtime":1628309540000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\文档\\张天赐\\练习代码\\VSCode\\个人博客\\前台\\myblog-frontend-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwU3RhdGV9IGZyb20gJ3Z1ZXgnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHVzZXI6IHsKICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAnJywKICAgICAgICAgICAgICAgIG5pY2tuYW1lOiAnJywKICAgICAgICAgICAgICAgIGF2YXRhcjogJycsCiAgICAgICAgICAgICAgICBlbWFpbDogJycsCiAgICAgICAgICAgICAgICBwYXNzd29yZDogJycsCiAgICAgICAgICAgICAgICB0eXBlOiAwCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIC8vIOihqOWNleaVsOaNrue7keWumuWvueixoQogICAgICAgICAgICBGb3JtOiB7CiAgICAgICAgICAgICAgICBuaWNrbmFtZTogJycsCiAgICAgICAgICAgICAgICB1c2VybmFtZTogJycsCiAgICAgICAgICAgICAgICBwYXNzd29yZDogJycsCiAgICAgICAgICAgICAgICBlbWFpbDogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgLy8g6KGo5Y2V6aqM6K+B6KeE5YiZ5a+56LGhCiAgICAgICAgICAgIEZvcm1SdWxlczogewogICAgICAgICAgICAgICAgLy8g6aqM6K+B55So5oi35piv5ZCm5ZCI5rOVCiAgICAgICAgICAgICAgICB1c2VybmFtZTogWwogICAgICAgICAgICAgICAgICAgIC8vIOW/heWhq++8jOaPkOekuua2iOaBr++8jOm8oOagh+eEpueCuea2iOWkseaXtuinpuWPkQogICAgICAgICAgICAgICAgICAgIHtyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeeUqOaIt+WQjSIsIHRyaWdnZXI6ICJibHVyIn0sCiAgICAgICAgICAgICAgICAgICAge21pbjogMiwgbWF4OiAxMCwgbWVzc2FnZTogIumVv+W6puWcqDItMTDkuKrlrZfnrKbkuYvpl7QifQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIC8vIOmqjOivgeeUqOaIt+aYr+WQpuWQiOazlQogICAgICAgICAgICAgICAgbmlja25hbWU6IFsKICAgICAgICAgICAgICAgICAgICAvLyDlv4XloavvvIzmj5DnpLrmtojmga/vvIzpvKDmoIfnhKbngrnmtojlpLHml7bop6blj5EKICAgICAgICAgICAgICAgICAgICB7cmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fovpPlhaXmmLXnp7AiLCB0cmlnZ2VyOiAiYmx1ciJ9LAogICAgICAgICAgICAgICAgICAgIHttaW46IDIsIG1heDogMTAsIG1lc3NhZ2U6ICLplb/luqblnKgyLTEw5Liq5a2X56ym5LmL6Ze0In0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAvLyDpqozor4Hlr4bnoIHmmK/lkKblkIjms5UKICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBbCiAgICAgICAgICAgICAgICAgICAge3JlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5a+G56CBIiwgdHJpZ2dlcjogImJsdXIifSwKICAgICAgICAgICAgICAgICAgICB7bWluOiA2LCBtYXg6IDEwLCBtZXNzYWdlOiAi6ZW/5bqm5ZyoIDYg5YiwIDEwIOS4quWtl+espiIsIHRyaWdnZXI6ICJibHVyIn0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRpYWxvZ0ltYWdlVXJsOiAnJwogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDogewogICAgICAgIC4uLm1hcFN0YXRlKFsKICAgICAgICAgICAgJ3JlZ2lzdG9yRm9ybVZpc2lhYmxlJwogICAgICAgIF0pCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIGFzeW5jIGhhbmRsZVN1Y2Nlc3MocmVzKSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcy5kYXRhKQogICAgICAgICAgICB0aGlzLmRpYWxvZ0ltYWdlVXJsID0gcmVzLmRhdGEKICAgICAgICB9LAogICAgICAgIGhhbmRsZVJlbW92ZSgpIHsKICAgICAgICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9ICcnCiAgICAgICAgfSwKICAgICAgICBoYW5kbGVQaWN0dXJlQ2FyZFByZXZpZXcoZmlsZSkgewogICAgICAgICAgICB0aGlzLmRpYWxvZ0ltYWdlVXJsID0gZmlsZS51cmw7CiAgICAgICAgfSwKICAgICAgICByZXNldEZvcm0oKSB7CiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnY2FuY2VsUkZWJykKICAgICAgICAgICAgdGhpcy4kcmVmcy5Gb3JtUmVmLnJlc2V0RmllbGRzKCkKICAgICAgICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9ICcnCiAgICAgICAgfSwKICAgICAgICBiZWZvcmVBdmF0YXJVcGxvYWQoZmlsZSkgewogICAgICAgICAgICBjb25zdCBpc0x0Mk0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDI7CiAgICAgICAgICAgIGlmICghaXNMdDJNKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkuIrkvKDlpLTlg4/lm77niYflpKflsI/kuI3og73otoXov4cgMk1CIScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBpc0x0Mk07CiAgICAgICAgfSwKICAgICAgICAvLyDnlKjmiLfnmbvlvZUKICAgICAgICB1c2VyUmVnaXN0ZXIoKSB7CiAgICAgICAgICAgIHRoaXMuJHJlZnMuRm9ybVJlZi52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm47CiAgICAgICAgICAgICAgICB0aGlzLnVzZXIudXNlcm5hbWUgPSB0aGlzLkZvcm0udXNlcm5hbWUKICAgICAgICAgICAgICAgIHRoaXMudXNlci5uaWNrbmFtZSA9IHRoaXMuRm9ybS5uaWNrbmFtZQogICAgICAgICAgICAgICAgdGhpcy51c2VyLmVtYWlsID0gdGhpcy5Gb3JtLmVtYWlsCiAgICAgICAgICAgICAgICB0aGlzLnVzZXIuYXZhdGFyID0gdGhpcy5kaWFsb2dJbWFnZVVybAogICAgICAgICAgICAgICAgdGhpcy51c2VyLnBhc3N3b3JkID0gdGhpcy4kbWQ1KHRoaXMuRm9ybS5wYXNzd29yZCkKICAgICAgICAgICAgICAgIGxldCBsb2NhbCA9IGF3YWl0IHRoaXMuZ2V0TG9jYWxDaXR5KCkKICAgICAgICAgICAgICAgIHRoaXMudXNlci5sb2dpblByb3ZpbmNlID0gbG9jYWwucmVzdWx0LmFkX2luZm8ucHJvdmluY2UKICAgICAgICAgICAgICAgIHRoaXMudXNlci5sb2dpbkNpdHkgPSBsb2NhbC5yZXN1bHQuYWRfaW5mby5jaXR5CiAgICAgICAgICAgICAgICB0aGlzLnVzZXIubG9naW5MYXQgPSBsb2NhbC5yZXN1bHQubG9jYXRpb24ubGF0CiAgICAgICAgICAgICAgICB0aGlzLnVzZXIubG9naW5MbmcgPSBsb2NhbC5yZXN1bHQubG9jYXRpb24ubG5nCiAgICAgICAgICAgICAgICBjb25zdCB7ZGF0YTogcmVzfSA9IGF3YWl0IHRoaXMuJGJsb2cucG9zdCgnL3JlZ2lzdG9yJywgewogICAgICAgICAgICAgICAgICAgIHVzZXI6IHRoaXMudXNlcgogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSAhPT0gMjAwKSByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcigi5rOo5YaM5aSx6LSlIikKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcykKICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMuRm9ybVJlZi5yZXNldEZpZWxkcygpCiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHttZXNzYWdlOiAn5rOo5YaM5oiQ5YqfJywgdHlwZTogJ3N1Y2Nlc3MnLCBvZmZzZXQ6IDgwfSk7CiAgICAgICAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgidG9rZW4iLCBKU09OLnN0cmluZ2lmeShyZXMuZGF0YS50b2tlbikpOwogICAgICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oInVzZXIiLCBKU09OLnN0cmluZ2lmeShyZXMuZGF0YS51c2VyKSk7CiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2dldFVzZXJJbmZvJykKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnY2FuY2VsUkZWJykKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGdldExvY2FsQ2l0eSgpewogICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgIGtleTogJ0lVVEJaLVVIQUtVLVBENlZJLUJaRUVZLU4zWVQzLVNDQjZKJywKICAgICAgICAgICAgICAgIG91dHB1dDonanNvbnAnCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IHVybCA9ICdodHRwczovL2FwaXMubWFwLnFxLmNvbS93cy9sb2NhdGlvbi92MS9pcCcKICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kanNvbnAodXJsLCBkYXRhKSkKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kanNvbnAodXJsLCBkYXRhKQogICAgICAgICAgICByZXR1cm4gcmVzCiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["Register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Register.vue","sourceRoot":"src/components/login","sourcesContent":["<template>\n    <el-dialog class=\"dialog\" title=\"请登录\" :visible.sync=\"registorFormVisiable\" @close=\"resetForm\" width=\"400px\" center>\n        <el-form ref=\"FormRef\" :model=\"Form\" :rules=\"FormRules\" class=\"form\" label-width=\"80px\" label-position=\"left\">\n            <!--        昵称-->\n            <el-form-item label=\"昵称\" prop=\"nickname\">\n                <el-input v-model=\"Form.nickname\"></el-input>\n            </el-form-item>\n            <!--        用户名-->\n            <el-form-item label=\"用户名\" prop=\"username\">\n                <el-input v-model=\"Form.username\"></el-input>\n            </el-form-item>\n            <!--        密码-->\n            <el-form-item label=\"密码\" prop=\"password\">\n                <el-input type=\"password\" v-model=\"Form.password\"></el-input>\n            </el-form-item>\n            <!--        密码-->\n            <el-form-item label=\"邮箱\" prop=\"email\">\n                <el-input v-model=\"Form.email\"></el-input>\n            </el-form-item>\n            <!--        头像-->\n            <el-form-item prop=\"avatar\" label=\"头像\">\n                <el-upload\n                        class=\"avatar-uploader\"\n                        ref=\"upload\"\n                        action=\"http://hikari.top:8090/upload\"\n                        :limit=\"1\"\n                        :show-file-list=\"false\"\n                        :on-remove=\"handleRemove\"\n                        :on-success=\"handleSuccess\"\n                        :before-upload=\"beforeAvatarUpload\">\n                    <img v-if=\"dialogImageUrl\" :src=\"dialogImageUrl\" class=\"avatar\">\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                </el-upload>\n            </el-form-item>\n            <el-form-item style=\"text-align: right\">\n                <el-button @click=\"resetForm\">取消</el-button>\n                <el-button type=\"primary\" @click=\"userRegister\">登录</el-button>\n            </el-form-item>\n        </el-form>\n    </el-dialog>\n</template>\n\n<script>\nimport {mapState} from 'vuex'\n\nexport default {\n    data() {\n        return {\n            user: {\n                username: '',\n                nickname: '',\n                avatar: '',\n                email: '',\n                password: '',\n                type: 0\n            },\n            // 表单数据绑定对象\n            Form: {\n                nickname: '',\n                username: '',\n                password: '',\n                email: ''\n            },\n            // 表单验证规则对象\n            FormRules: {\n                // 验证用户是否合法\n                username: [\n                    // 必填，提示消息，鼠标焦点消失时触发\n                    {required: true, message: \"请输入用户名\", trigger: \"blur\"},\n                    {min: 2, max: 10, message: \"长度在2-10个字符之间\"}\n                ],\n                // 验证用户是否合法\n                nickname: [\n                    // 必填，提示消息，鼠标焦点消失时触发\n                    {required: true, message: \"请输入昵称\", trigger: \"blur\"},\n                    {min: 2, max: 10, message: \"长度在2-10个字符之间\"}\n                ],\n                // 验证密码是否合法\n                password: [\n                    {required: true, message: \"请输入密码\", trigger: \"blur\"},\n                    {min: 6, max: 10, message: \"长度在 6 到 10 个字符\", trigger: \"blur\"}\n                ],\n            },\n            dialogImageUrl: ''\n        }\n    },\n    computed: {\n        ...mapState([\n            'registorFormVisiable'\n        ])\n    },\n    methods: {\n        async handleSuccess(res) {\n            // console.log(res.data)\n            this.dialogImageUrl = res.data\n        },\n        handleRemove() {\n            this.dialogImageUrl = ''\n        },\n        handlePictureCardPreview(file) {\n            this.dialogImageUrl = file.url;\n        },\n        resetForm() {\n            this.$store.commit('cancelRFV')\n            this.$refs.FormRef.resetFields()\n            this.dialogImageUrl = ''\n        },\n        beforeAvatarUpload(file) {\n            const isLt2M = file.size / 1024 / 1024 < 2;\n            if (!isLt2M) {\n                this.$message.error('上传头像图片大小不能超过 2MB!');\n            }\n            return isLt2M;\n        },\n        // 用户登录\n        userRegister() {\n            this.$refs.FormRef.validate(async valid => {\n                if (!valid) return;\n                this.user.username = this.Form.username\n                this.user.nickname = this.Form.nickname\n                this.user.email = this.Form.email\n                this.user.avatar = this.dialogImageUrl\n                this.user.password = this.$md5(this.Form.password)\n                let local = await this.getLocalCity()\n                this.user.loginProvince = local.result.ad_info.province\n                this.user.loginCity = local.result.ad_info.city\n                this.user.loginLat = local.result.location.lat\n                this.user.loginLng = local.result.location.lng\n                const {data: res} = await this.$blog.post('/registor', {\n                    user: this.user\n                })\n                if (res.code !== 200) return this.$message.error(\"注册失败\")\n                // console.log(res)\n                this.$refs.FormRef.resetFields()\n                this.$message({message: '注册成功', type: 'success', offset: 80});\n                window.sessionStorage.setItem(\"token\", JSON.stringify(res.data.token));\n                window.sessionStorage.setItem(\"user\", JSON.stringify(res.data.user));\n                this.$store.commit('getUserInfo')\n                this.$store.commit('cancelRFV')\n            })\n        },\n        async getLocalCity(){\n            let data = {\n                key: 'IUTBZ-UHAKU-PD6VI-BZEEY-N3YT3-SCB6J',\n                output:'jsonp'\n            }\n            let url = 'https://apis.map.qq.com/ws/location/v1/ip'\n            // console.log(this.$jsonp(url, data))\n            const res = await this.$jsonp(url, data)\n            return res\n        }\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n    .avatar-uploader .el-upload {\n        cursor: pointer;\n        position: relative;\n        overflow: hidden;\n    }\n\n    .avatar-uploader .el-upload:hover {\n        border-color: #409EFF;\n    }\n\n    .avatar-uploader-icon {\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        font-size: 28px;\n        color: #8c939d;\n        width: 100px;\n        height: 100px;\n        line-height: 100px;\n        text-align: center;\n    }\n\n    .avatar {\n        width: 100px;\n        height: 100px;\n        display: block;\n    }\n\n    .login_form {\n        width: 100%;\n        padding: 0 20px;\n        box-sizing: border-box;\n    }\n\n    .btns {\n        display: flex;\n        justify-content: flex-end;\n    }\n\n    .login_dialog {\n        opacity: 1;\n    }\n\n</style>\n"]}]}